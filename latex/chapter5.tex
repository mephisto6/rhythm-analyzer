%----------------------------------------------------------------------------
\chapter{Eredmények}
%----------------------------------------------------------------------------

Az elméleti alapok és a megvalósítás részletei után lássunk néhány szép és viszonylag könnyen értelmezhetõ eredményt, amelyekre az elkészült alkalmazás által számított kimeneti adatokat elemezve juthatunk, illetve ellenõrizhetjük annak helyes mûködését. Ehhez két, egymástól eltérõ vizualizációs eszközhöz fordulunk segítségért, az egyik a Multidimensional Scaling (MDS), a másik a Neighbor Net és a ráépülõ SplitsTree alkalmazás. 

A vizsgált csoportok alapegysége a korábbi kutatásokból származó (dallamvonal alapján számított) dallamosztály. Egy ilyen csoport nagyjából $20$ és $50$ közötti dalt tartalmaz.

%----------------------------------------------------------------------------
\section{Multidimensional Scaling}
%----------------------------------------------------------------------------

Az MDS olyan dimenziócsökkentõ eljárások gyûjteménye, melyeket gyakran használnak arra, hogy vizualizációval tegyék könnyebbé adatok közti összefüggések megértését és felfedezését. A projekt korábbi szakaszában készült olyan implementáció, ami ezt alkalmazza a vizualizációra, ezért kézenfekvõ, hogy kipróbáljuk az eredmények elemzése céljából.

Az algoritmus távolságmátrix alapján egy elõre megadott $N$ dimenziós térbe képzi le az elemeket. Ha ezt az $N$-t kellõen kicsinek ($2$ vagy $3$) választjuk, a kapott térkép emberi érzékelésünk számára is könnyen értelmezhetõvé válik.

%----------------------------------------------------------------------------
\subsection{Az MDS mûködése}
%----------------------------------------------------------------------------

Az algoritmus röviden összefoglalva a következõ lépésekbõl áll \cite{Wickelmaier}:

\begin{enumerate}
\item Elõször a távolságmátrix minden $p_{ij}$ elemét helyettesítjük $q_{ij}=(1-p_{ij})^2$ elemmel, így egy olyan értéket kapunk, mely a pontok közötti távolsággal fordítottan arányos.
\item Ezután az elemekhez olyan pontokat rendelünk a síkon, melyek közötti $d_{ij}$ távolságok a korábban meghatározott $q_{ij}$-khez konvergálnak. Ezt az alábbi $S$ stresszfüggvény minimalizálásával tehetjük meg:
\begin{align}
S=\sum_{i=1}^D \sum_{j=1}^D (d_{ij}-q_{ij})^2
\end{align}
ahol $D$ az elemek számát jelöli.
\end{enumerate}
%\item Vegyük a $\mathbf{P}$ távolságmátrix elemeinek négyzetét tartalmazó $\mathbf{P^{(2)}}$ mátrixot.
%\item Számoljuk ki $\mathbf{B}$ skalárszorzat mátrixot a következõképp: $\mathbf{B}=-\frac{1}{2}\mathbf{J}\mathbf{P^{(2)}}\mathbf{J}$, ahol $\mathbf{J}=\mathbf{I}-\frac{1}{n}\mathbf{1}$, $n$ pedig az elemek száma ($\mathbf{1}$ a csupa egyesekbõl álló mátrix).
%\item Határozzuk meg $\mathbf{B}$ mátrix $N$ legnagyobb sajátértékét ($\lambda_1,\dots,\lambda_N$) és a hozzájuk tartozó sajátvektorokat ($\mathbf{e}_1,\dots,\mathbf{e}_N$).
%\item Végül a koordináták $\mathbf{X}$ mátrixát az $\mathbf{X}=\mathbf{E}_N \mathbf{\Lambda}_N^{\frac{1}{2}}$ képlet segítségével kapjuk, ahol $\mathbf{E}_N$ az $N$ sajátvektor-alkotta mátrixot jelöli, $\mathbf{\Lambda}_N$-t pedig az $N$ sajátértékbõl képzett diagonális mátrix.
%A következõ szakaszokban bemutatott térképek két dimenzióra lettek leképezve ($N=2$).

A kezdeti véletlen rendezésbõl egy gradiens alapú algoritmus segítségével jutunk el az ideálisba, melynek részletezése megtalálható a forrásjegyzékben \cite{MDS}.

%----------------------------------------------------------------------------
\subsection{Az elsõ dallamosztály ritmikai szerkezete}
%----------------------------------------------------------------------------

\begin{figure}[!h]
\centering
\includegraphics[width=100mm, keepaspectratio]{figures/cluster1MDS.png}
\caption{Az $1.$ dallam szerinti osztály dalai MDS-sel ábrázolva (Hamming távolság alapján)} 
\label{fig:cluster1MDS}
\end{figure}

\begin{figure}[!h]
\centering
\includegraphics[width=100mm, keepaspectratio]{figures/cluster1MDScomplete.png}
\caption{Complete linkage szerinti klaszterek}
\label{fig:cluster1MDScomplete}
\end{figure}

\begin{figure}[!h]
\centering
\includegraphics[width=100mm, keepaspectratio]{figures/cluster1MDSkmeans.png}
\caption{k-means szerinti klaszterek}
\label{fig:cluster1MDSkmeans}
\end{figure}

Az \ref{fig:cluster1MDScomplete}-\ref{fig:cluster1MDSkmeans} ábrákon látható a $30$ dalból álló elsõ dallamvonal szerinti osztály Hamming-távolság alapján számított MDS-térképe adott algoritmus szerinti klaszterek szerint színezve.

Meglehetõsen kuszának tûnik, így nem is csoda, hogy a single linkage algoritmus $3$ outlier ponton (($169$), ($760$), ($1476$)) és egy kételemû csoporton ($378$, $764$) kívül egy minden más elemet tartalmazó klasztert talál. Az average egy kicsivel jobban teljesít, az alsó fürtöt ($299$, $376$, $377$) sikeresen szeparálja a többi elemtõl. A complete a nagy és sûrû klasztert felbontja két kisebb, egymást érintõ klaszterre (\ref{fig:cluster1MDScomplete} ábra). 

Az \ref{fig:cluster1MDSkmeans} ábrán látható, hogy a $k$-means a piros pontokat ránézésre véletlenszerûen még két részre bontja. Sajnos a DBSCAN algoritmus kevés értékelhetõ eredményt ad, ez azonban nem meglepõ, hiszen a kapott térképen sem látunk igazán jól elkülönülõ sûrûsödéseket.



%\begin{figure}[!h]
%\begin{center}$
%\begin{array}{cc}
%\includegraphics[width=75mm, keepaspectratio]{figures/cluster1MDSaverage.png} & 
%\includegraphics[width=75mm, keepaspectratio]{figures/cluster1MDScomplete.png}
%\end{array}$
%\end{center}
%\caption{Average és complete linkage szerinti klaszterek}
%\label{fig:cluster1MDSlinkage}
%\end{figure}

Ha megvizsgáljuk a kapott klaszterek elemeinek kottáit, felfedezhetjük azokat a közös ritmikai tulajdonságaikat, amelyek alapján egy csoportba lettek sorolva. 

%----------------------------------------------------------------------------
\subsubsection{Az elsõ klaszter}
%----------------------------------------------------------------------------

Az \ref{fig:cluster1furt1} ábrán látható dalok (az \ref{fig:cluster1MDScomplete} ábrán zöld pontok) a gyimesi csángók sajátos páros táncának, az aszimmetrikus lüktetésû (10/16-os ütemû) lassú magyarosnak változatai \cite{Szenik}.

\begin{figure}[!h]
\centering
\includegraphics[width=120mm, keepaspectratio]{figures/cluster1furt1.png}
\caption{Az elsõ klaszter kottái} 
\label{fig:cluster1furt1}
\end{figure}

%----------------------------------------------------------------------------
\subsubsection{A második klaszter}
%----------------------------------------------------------------------------

A második klaszter elemeinek (az \ref{fig:cluster1MDScomplete} ábrán kékkel jelölve) kottáit láthatjuk az \ref{fig:cluster1furt2} ábrán. Ha szakértõi szemmel vizsgáljuk õket, akkor kiderül, hogy ezek a parlando (beszédszerû elõadásmódú) keservesek csoportját alkotják. Ezek a lírai dalok a lexikon \cite{Neprajzi} szerint mély lelki fájdalomból fakadó, bánatos hangvételû egyéni panaszdalok, melyeknek zenei ritmusa, a hangok idõértéke teljes egészében a szövegmondáshoz igazodik.

\begin{figure}[!h]
\centering
\includegraphics[width=150mm, keepaspectratio]{figures/cluster1furt2.png}
\caption{A második klaszter kottái} 
\label{fig:cluster1furt2}
\end{figure}

%----------------------------------------------------------------------------
\subsubsection{A harmadik klaszter}
%----------------------------------------------------------------------------

A harmadik klaszterhez (az \ref{fig:cluster1MDScomplete} ábra piros pontjai) tartozó kottákon ugyanannak a dallamnak a hangszeres elõadásmód során variálódó ritmusát ($1594$-$1379$-$392$) követhetjük figyelemmel (\ref{fig:cluster1furt3} ábra).

\begin{figure}[!h]
\centering
\includegraphics[width=150mm, keepaspectratio]{figures/cluster1furt3.png}
\caption{A harmadik klaszter kottái} 
\label{fig:cluster1furt3}
\end{figure}

%----------------------------------------------------------------------------
\subsubsection{A negyedik klaszter}
%----------------------------------------------------------------------------

Az \ref{fig:cluster1MDScomplete} ábrán barna színnel jelölt, $k$-means szerinti negyedik klaszter mindhárom linkage algoritmus kimenetében beleolvadt egy másik klaszterba, aminek oka a szoros kapcsolat a határaikon lévõ elemek között. (Ha alaposan szemügyre vesszük, megfigyelhetõ, hogy a harmadik klaszterbe sorolt $288$ azonosítójú dal ritmusa mennyire hasonlít a negyedik klaszterbe sorolt $212$-esére).

\begin{figure}[!h]
\centering
\includegraphics[width=150mm, keepaspectratio]{figures/cluster1furt4.png}
\caption{A negyedik klaszter kottái} 
\label{fig:cluster1furt4}
\end{figure}

%\vspace{12pt}

Az \ref{app:2ndcluster} számú függelék tartalmazza a második dallamosztályra kapott osztályozásokhoz tartozó kottákat azok közös tulajdonságainak rövid leírásával együtt.

%----------------------------------------------------------------------------
\section{A SplitsTree alkalmazása}
%----------------------------------------------------------------------------

A SplitsTree egy bioinformatikai alkalmazásokban népszerû következtetõ és vizualizáló szoftver, amely képes arra, hogy távolságmátrixban adott távolságokon alapuló ,,térképet'' rajzoljon az adathalmaz elemeihez. Ehhez természetesen csak szimmetrikus távolságértékeket tartalmazó mátrixot tud értelmezni.

A szoftver speciális, NEX kiterjesztésû fájlok segítségével mûködik, melyek tartalmazzák a távolságmátrixot és számos más metainformációt. Ahogy a \ref{sect:nexus} fejezetben említettem, az elkészült alkalmazás képes ilyen fájlok generálására. 

%----------------------------------------------------------------------------
\subsection{A Neighbor Net algoritmus}
%----------------------------------------------------------------------------

A SplitsTree által generált ábrák a Neighbor Net algoritmus segítségével készülnek, melynek lépései nagy vonalakban a következõek \cite{Bryant}:
\begin{enumerate}
\item Kezdetben minden elem egy különálló pont. 
\item Minden iterációs lépésnél kiválasztunk egy pontpárt, addig amíg legalább $3$ pontunk van. Ekkor azonban még nem feltétlenül vonjuk össze õket, ahogy azt tettük volna a linkage algoritmusok során. Csak akkor vonunk össze pontokat, ha másodszorra is beválasztottuk ugyanazt a pontot a párba (jelöljük ezt a pontot $x$-szel). Ekkor $x, y$ és $z$ összekötött pontokból létrehozunk két új, $u$ és $v$ egymással szintúgy összeköttetésben lévõ pontot (melyek az ábrán belsõ pontok lesznek). 
\item Frissítjük a távolságmátrixot: $u$ és egy tetszõleges $w$ között a távolság az $u$ által reprezentált pontok ($x$ és $y$) és $w$ távolságának speciális függvénye, majd folytatjuk a kettes pontnál.
\end{enumerate}

A pontpárok kiválasztásához használt formulát és a távolságmátrix redukciója során alkalmazott távolsági képletet itt nem részletezzük, megtalálható a forrásdokumentumokban \cite{Bryant}.

%----------------------------------------------------------------------------
\subsection{Az ötödik dallamosztály ritmikai szerkezete}
%----------------------------------------------------------------------------

Vizsgáljuk meg, hogy a klaszterezések által adott eredmények mennyire tükrözõdnek a SplitsTree által rajzolt fákon! Ehhez használjuk az $5.$ dallam szerinti csoport $33$ elemét. Ekkor az alapértelmezett $K$ az \ref{eq:defk} képlet szerint $\sqrt{\frac{33}{2}}\approx 4$.

\begin{figure}[!h]
\centering
\includegraphics[width=108mm, keepaspectratio]{figures/cluster5single.png}
\caption{Single linkage szerinti színezés} 
\label{fig:cluster5single}
\end{figure}

A \ref{fig:cluster5single} ábrán látható, hogy mi történhet túl közeli elemeket tartalmazó klaszterek esetén a single linkage algoritmussal: egy nagy klaszterbe mosódnak össze az elemek (és kapunk $3$ mindenkitõl távolra esõ outlier pontok alkotta egyelemû klasztert). Ahogy korábban említésre került, erre megoldást nyújthat egy maximális távolságérték megadása, amelyet elérve már nem húzunk össze klasztereket, de ennek a paraméternek a kiszámítása nem könnyû, ráadásul adathalmazonként változik is.

\begin{figure}[!h]
\centering
\includegraphics[width=108mm, keepaspectratio]{figures/cluster5average.png}
\caption{Average linkage szerinti színezés} 
\label{fig:cluster5average}
\end{figure}

A \ref{fig:cluster5average} ábra mutatja, hogy az average linkage algoritmus ennél hatékonyabb, hiszen használatával két egymástól jól elkülönülõ, nagy klasztert és két, egy-egy outlier pontból álló klasztert kapunk.

\begin{figure}[!h]
\centering
\includegraphics[width=108mm, keepaspectratio]{figures/cluster5complete.png}
\caption{Complete linkage szerinti színezés} 
\label{fig:cluster5complete}
\end{figure}

A complete linkage klaszterezés tûnik a legjobb választásnak, hiszen ez az, amelyik a szemmel látható $3$ fõ klasztert pontosan azonosítja (\ref{fig:cluster5complete} ábra). Ettõl egyetlen, középen lévõ elem különbözõ besorolásával tér el a legtávolabbi elemek alkotta klaszterekkel induló $k$-means algoritmus (\ref{fig:cluster5kmeans} ábra) kimenete, tehát ez is megfelelõ eredményt ad.

\begin{figure}[!h]
\centering
\includegraphics[width=108mm, keepaspectratio]{figures/cluster5kmeans.png}
\caption{$k$-means szerinti színezés} 
\label{fig:cluster5kmeans}
\end{figure}

\begin{figure}[!h]
\centering
\includegraphics[width=108mm, keepaspectratio]{figures/cluster5dbscan.png}
\caption{DBSCAN szerinti színezés} 
\label{fig:cluster5dbscan}
\end{figure}

A DBSCAN algoritmus kimenete sem meglepõ: eredményesen megtalálja az egymáshoz közel esõ sûrûsödéseket, összesen $4$-et (\ref{fig:cluster5dbscan} ábra). Több elemrõl állítja, hogy outlier, mint az eddigiek, de az általa adott klasztereken belüli elemek valóban nagyon közel vannak egymáshoz. Az egyetlen nehézség ezzel a módszerrel az, hogy sokat kellett ,,játszani'' a két paraméterrel, hogy értelmezhetõ eredményt kapjunk (itt most $minPts = 2$ és $\varepsilon = 0.17$).

Ha vetünk egy pillantást a klaszterek elemire, kiderül, hogy az \ref{fig:cluster5furt1} ábrán látható dalok közös tulajdonsága a ti-táj-táá zárlat, az ezekhez tartozó dalok a fenti complete linkage szerinti \ref{fig:cluster5complete} ábra kékkel és pirossal jelölt elemei. 

\begin{figure}[!h]
\centering
\includegraphics[width=142mm, keepaspectratio]{figures/cluster5furt1.png}
\caption{Az elsõ klaszter kottái} 
\label{fig:cluster5furt1}
\end{figure}

Az \ref{fig:cluster5furt2} ábra a táá-táá zárlatú dalok kottáit tartalmazza (ezek pedig a $k$-means szerinti \ref{fig:cluster5kmeans} ábra pirossal jelölt elemei).

\begin{figure}[!h]
\centering
\includegraphics[width=120mm, keepaspectratio]{figures/cluster5furt2.png}
\caption{A második klaszter kottái} 
\label{fig:cluster5furt2}
\end{figure}

\subsubsection{További távolságmetrikák használata}

Tanulságos lehet megfigyelni, hogy különbözõ módszerrel számított távolságmátrix alapján rajzolt ábrák klaszterezései is hasonló eredményt mutatnak-e. Ehhez vizsgáljuk meg az intervallum-vektorok Euklideszi-távolsága alapján számított távolságmátrixból épült fát és rajta az average linkage klaszterezés szerinti színezést (\ref{fig:cluster5euc_average} ábra). A színeket úgy választottam meg, hogy látható legyen a klaszterezés eredményeinek hasonlósága. 

A Hamming-távolság és az Euklideszi-távolság szerinti klaszterek csak néhány elemben térnek el, pedig különbözõ vektorokra számítottuk õket. A trendek mégis mindkettõben láthatóak, a különbségek pedig annak bizonyítékai, hogy nem mindig határozható meg egyértelmûen egy elem csoportja, gyakran vannak átfedések is.

További összehasonlítások alapján készült ábrákat láthatunk ugyanerre a dallamosztályra az \ref{app:splits} számú függelékben.

\begin{figure}[!h]
\centering
\includegraphics[width=108mm, keepaspectratio]{figures/cluster5euc_average.png}
\caption{Euklideszi távolság alapján rajzolt fa average linkage szerinti színezése} 
\label{fig:cluster5euc_average}
\end{figure}

%----------------------------------------------------------------------------
\section{Összegzés}
%----------------------------------------------------------------------------

Amint ezeken a példákon követhetõ volt, az algoritmusok meglehetõsen ügyesen csoportosítják az elemeket, de ehhez megfelelõ paraméterválasztás szükséges. Nem mindig bizonyul helyesnek a $K$-ra adott becslés, illetve a DBSCAN paramétereinek megválasztása sem triviális feladat.